!function(e){var t={};function c(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,c),o.l=!0,o.exports}c.m=e,c.c=t,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c(c.s=0)}({0:function(e,t,c){c("9LLj"),e.exports=c("mxJi")},"9LLj":function(e,t,c){"use strict";c.r(t);var n=c("VRpJ"),o=c("Fi/m");window.WpcwVue&&document.addEventListener("DOMContentLoaded",function(e){WpcwVue.component("wpcw-field-convertkitselect",n.a),WpcwVue.component("wpcw-field-convertkitwebhooks",o.a);new WpcwVue({el:"#convertkit-forms"}),new WpcwVue({el:"#convertkit-sequences"}),new WpcwVue({el:"#convertkit-tags"}),new WpcwVue({el:"#convertkit-webhooks"})})},"Fi/m":function(e,t,c){"use strict";(function(e){t.a={template:"#wpcw-field-convertkitwebhooks",props:{course_id:{default:0}},data:function(){return{name:"",type:"",tag:"",form:"",sequence:"",typeSelect:"",objectSelect:"",selectType:"",selectData:"",args:{},webhooks:[],create:!1,creating:!1,saving:!1}},created:function(){var e=this;WpcwEvents.$on("modalOpened",function(t){return e.modalActivated()}),WpcwEvents.$on("modalClose",function(t){return e.modalDeactivated()}),WpcwEvents.$on("typeSelected",function(t){var c=t.type;return e.typeSelected(c)}),WpcwEvents.$on("typeUnselected",function(t){var c=t.type;return e.typeUnSelected(c)}),WpcwEvents.$on("dataSelected",function(t){return e.dataSelected(t)}),WpcwEvents.$on("dataUnSelected",function(t){return e.dataUnSelected(t)})},mounted:function(){this.getWebhooks()},computed:{isTagsNeeded:function(){return"tags"===this.selectType},isFormsNeeded:function(){return"forms"===this.selectType},isSequencesNeeded:function(){return"sequences"===this.selectType}},methods:{getWebhooks:function(){var e=this;WpcwApi.get("convertkit-webhooks",{course_id:this.course_id}).then(function(t){e.webhooks=t.webhooks})},createWebhook:function(){WpcwModal.open("#wpcw-field-convertkitwebhooks-modal",{},!0)},initTypeSelect:function(){var t=e("#wpcw-field-convertkitselect-type-dropdown"),c=!!t.data("allow_clear"),n=t.data("placeholder");this.typeSelect=t.wpcwselect2({theme:"wpcw",multiple:!1,allowClear:c,placeholder:n,width:"100%"}).on("wpcwselect2:select",function(e){var t=e.params.data;WpcwEvents.$emit("typeSelected",{type:t.id})}).on("wpcwselect2:unselect",function(e){var t=e.params.data;WpcwEvents.$emit("typeUnselected",{type:t.id})})},typeSelected:function(e){switch(this.type=e,e){case"tag_add":case"tag_remove":this.selectType="tags";break;case"form":this.selectType="forms";break;case"sequence":case"sequence_complete":this.selectType="sequences";break;default:this.selectType=""}this.loadObjectsData()},typeUnSelected:function(e){this.reset()},loadObjectsData:function(){var e=this;""!==this.selectType&&WpcwApi.get("convertkit-"+this.selectType).then(function(t){e.selectData=e.formatForSelect2(t.objects),e.initObjectsSelect()})},initObjectsSelect:function(){var t=this,c=e("#wpcw-field-convertkitselect-"+t.selectType+"-dropdown"),n=!!c.data("allow_clear"),o=c.data("placeholder");this.objectSelect=c.wpcwselect2({theme:"wpcw",multiple:!1,allowClear:n,placeholder:o,width:"100%",data:t.selectData}).on("wpcwselect2:select",function(e){var c=e.params.data;WpcwEvents.$emit("dataSelected",{id:c.id,type:t.selectType})}).on("wpcwselect2:unselect",function(e){var c=e.params.data;WpcwEvents.$emit("dataUnselected",{id:c.id,type:t.selectType})})},formatForSelect2:function(t){var c=[];return e.each(t,function(e,t){c.push({id:e,text:t,selected:!1})}),c},dataSelected:function(e){if(e.id&&e.type)switch(e.type){case"forms":this.form=e.id;break;case"tags":this.tag=e.id;break;case"sequences":this.sequence=e.id}},dataUnSelected:function(e){},modalActivated:function(){this.create=!0,this.initTypeSelect()},modalDeactivated:function(){this.create=!1,this.reset()},reset:function(){this.type="",this.tag="",this.form="",this.sequence="",this.selectType="",this.selectData="",this.typeSelect&&this.typeSelect.val("").trigger("change"),this.objectSelect&&this.objectSelect.val("").trigger("change")},addWebhook:function(){var e=this;this.creating=!0,WpcwApi.post("convertkit-create-webhook",{course_id:this.course_id,name:this.name,type:this.type,tag:this.tag,form:this.form,sequence:this.sequence}).then(function(t){e.creating=!1,t.webhooks&&(e.webhooks=t.webhooks,e.name="",e.reset(),WpcwModal.close())})},deleteWebhook:function(e){var t=this;e.delete=!0,WpcwApi.post("convertkit-delete-webhook",{course_id:this.course_id,webhook_id:e.id}).then(function(c){c.webhooks?t.webhooks=c.webhooks:e.delete=!1})}}}}).call(this,c("xeH2"))},VRpJ:function(e,t,c){"use strict";(function(e){t.a={template:"#wpcw-field-convertkitselect",props:{id:{default:""},name:{default:""},placeholder:{default:""},objects:{default:""},object_type:{default:""}},data:function(){return{selectData:"",select:""}},created:function(){var e=this;WpcwEvents.$on("addObject",function(t){return e.addObject(t)}),WpcwEvents.$on("removeObject",function(t){return e.removeObject(t)})},mounted:function(){this.objects=JSON.parse(this.objects),this.loadData()},computed:{fieldId:function(){return"wpcw-field-convertkitselect-".concat(this.object_type,"-dropdown")}},methods:{loadData:function(){var e=this;WpcwApi.get("convertkit-"+this.object_type).then(function(t){e.selectData=e.formatForSelect2(t.objects),e.initSelect()})},initSelect:function(){var t=e("#wpcw-field-convertkitselect-"+this.object_type+"-dropdown"),c=!!t.data("allow_clear"),n=t.data("placeholder");this.select=t.wpcwselect2({theme:"wpcw",multiple:!0,allowClear:c,placeholder:n,width:"100%",data:this.selectData}).on("wpcwselect2:select",function(e){var t=e.params.data;WpcwEvents.$emit("addObject",{id:t.id,text:t.text})}).on("wpcwselect2:unselect",function(e){var t=e.params.data;WpcwEvents.$emit("removeObject",{id:t.id,text:t.text})})},formatForSelect2:function(t){var c=this,n=[];return e.each(t,function(e,t){var o=c.objects.find(function(t){return t===e});n.push({id:e,text:t,selected:!!o})}),n},addObject:function(e){this.objects.push(e)},removeObject:function(e){this.objects=this.objects.filter(function(t){return parseInt(t.id)!==parseInt(e.id)})}}}}).call(this,c("xeH2"))},mxJi:function(e,t){},xeH2:function(e,t){e.exports=jQuery}});